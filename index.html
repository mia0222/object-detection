<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>物体検知</title>
</head>
<body>
  <canvas id="canvas" width="640" height="480"></canvas>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/tensorflow.js/3.15.0/tensorflow.min.js"></script>
  <script>
    // カメラからの画像を読み取る
    const video = await navigator.mediaDevices.getUserMedia({
      video: true,
    });

    // 物体検知を行う
    const model = await tf.loadLayersModel('model.json');
    const tensor = tf.fromPixels(video.toDataURL());
    const detections = model.predict(tensor);

    // 検出した物体を表示する
    for (const detection of detections) {
      const boundingBox = detection.boundingBox;
      const confidence = detection.confidence;

      // 検出した物体の座標と信頼度を表示する
      console.log(boundingBox, confidence);

      // 検出した物体を描画する
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = 'red';
      ctx.fillRect(boundingBox.x, boundingBox.y, boundingBox.width, boundingBox.height);
    }
  </script>
</body>
</html>
